<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BCA Store</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body {font-family:'Fira Code', monospace; margin:0; padding:0; background:#0f111a; color:#cfd8dc;}
header {background:#1f2233; padding:20px; text-align:center;}
header h1 {color:#00ffcc; margin:0;}
#banner {background:linear-gradient(90deg,#ff5722,#ff9800); color:#fff; padding:10px; font-weight:bold; border-radius:8px; margin-top:10px;}
#visitorCount, #buyCount {color:#00ffcc; margin:5px;}
nav {display:flex; justify-content:center; padding:15px; background:#111426;}
nav select {padding:8px 12px; border-radius:6px; border:none; background:#22253b; color:#cfd8dc; font-size:1em;}
#searchBar, #checkOrder {display:block; margin:15px auto; width:90%; max-width:350px; padding:10px; border-radius:6px; border:none; background:#22253b; color:#cfd8dc;}
.container {display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:18px; padding:20px;}
.card {background:#1a1c2b; border-radius:12px; padding:12px; text-align:center; transition:all 0.3s; box-shadow:0 4px 10px rgba(0,255,204,0.2);}
.card:hover {transform:translateY(-5px) scale(1.03);}
.card img {width:100%; height:120px; object-fit:cover; border-radius:8px;}
.card h4 {color:#00ffcc; margin:10px 0 5px;}
.card p {margin:0 0 10px; color:#fff; font-size:0.9em;}
.btn {background:#00ffcc; color:#0f111a; padding:8px 14px; border:none; border-radius:6px; cursor:pointer;}
.btn:hover {background:#00d6b2;}
footer {text-align:center; padding:15px; background:#111426; font-size:0.9em; color:#cfd8dc;}
footer a {margin:0 8px; color:#00ffcc; cursor:pointer; text-decoration:underline;}
.modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); justify-content:center; align-items:center; z-index:999;}
.modal-content {background:#1a1c2b; color:#cfd8dc; padding:20px; border-radius:12px; width:90%; max-width:450px; max-height:80%; overflow:auto;}
.modal-content h3 {margin-top:0; color:#00ffcc;}
.modal-content input {width:100%; padding:10px; margin:8px 0; border-radius:6px; border:none; background:#22253b; color:#cfd8dc;}
.close {float:right; font-size:1.2em; cursor:pointer;}
.statusResult {text-align:center; color:#00ffcc; font-weight:bold; margin:10px 0;}
</style>
</head>
<body>

<header>
  <h1>BCA Store</h1>
  <div id="banner">ðŸ”¥ First 100 user get free pyq,notes linux ðŸ”¥</div>
  <div id="visitorCount">Visitors: 0</div>
  <div id="buyCount">Total Buyer: 0</div>
</header>

<nav>
  <select id="semesterSelect">
    <option value="sem1">Sem 1</option>
    <option value="sem2">Sem 2</option>
    <option value="sem3">Sem 3</option>
    <option value="sem4">Sem 4</option>
    <option value="sem5">Sem 5</option>
    <option value="sem6">Sem 6</option>
  </select>
</nav>

<input type="text" id="searchBar" placeholder="Search products...">
<input type="text" id="checkOrder" placeholder="Enter your Order ID to check status">
<div class="statusResult" id="statusResult"></div>

<div id="productContainer" class="container"></div>

<!-- Buy Modal -->
<div id="formModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3>Enter Your Details</h3>
    <input type="text" id="custName" placeholder="Your Name">
    <input type="email" id="custEmail" placeholder="Your Email">
    <input type="tel" id="custMobile" placeholder="Your Mobile">
    <button class="btn" onclick="placeOrder()">Buy via WhatsApp</button>
  </div>
</div>

<footer>
      <a onclick="alert('Order Placedâ†’ Order Confirmation â†’Order Processing â†’ Delivered')">Order Map</a>

  <a onclick="alert('Feedback editable in code.')">Feedback</a> |
  <a onclick="alert('All digital products are the original property of the BCA Store unless stated otherwise. Products are delivered digitally (download/email) after successful payment. Customers must ensure their device is compatible before purchase. Disclaimer: Some products are provided by third-party creators, and we do not claim ownership of those. Products are for personal/educational use only and cannot be resold or shared. Terms may be updated anytime without prior notice.')">Terms & Conditions</a> |
  
    <a onclick="alert('If you receive the wrong product, we will provide an immediate replacement. After delivery, you must raise any issue within 24 hours. Beyond this period, we do not provide refunds â€” only replacements (if your reason is genuine). If you face a technical or download issue after delivery, share a screenshot as proof. If your reason is genuine, you will receive a refund within 12 hours.')">Refund & Replacement Policy</a> |
  
  
  <a onclick="alert('Contact: shubhamkeshari232@gmail.com | 8956003559')">Contact Us</a>

  <p>mjkbca Â© 2025</p>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { 
  getFirestore, collection, addDoc, doc, getDoc, setDoc, updateDoc, increment, serverTimestamp, onSnapshot, query, where 
} from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyBBV_jXIewP2OfcqYxtj2regQCicduc2fY",
  authDomain: "ount-32a16.firebaseapp.com",
  projectId: "ount-32a16",
  storageBucket: "ount-32a16.firebasestorage.app",
  messagingSenderId: "865150215832",
  appId: "1:865150215832:web:d6ab92c351584c71aa12ed"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ------------------- Product Data -------------------
const semesters = {
  sem1: [
    { name: "Exam Guess 1", price: "100", img: "images/cprog.jpg" },
    { name: "Notes 1", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 1", price: "15", img: "images/math.jpg" },
    { name: "Source Code 1",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "19", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
  ],
  sem2: [
    { name: "Exam Guess 2", price: "110", img: "images/cprog.jpg" },
    { name: "Notes 2", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 2", price: "15", img: "images/math.jpg" },
    { name: "Source Code 2",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "18", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
  ],
  sem3: [
    { name: "Exam Guess 3", price: "110", img: "images/cprog.jpg" },
    { name: "Notes 3", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 3", price: "15", img: "images/math.jpg" },
    { name: "Source Code 3",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "18", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
  ], 
  sem4: [
    { name: "Exam Guess 4", price: "110", img: "images/cprog.jpg" },
    { name: "Notes 4", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 4", price: "15", img: "images/math.jpg" },
    { name: "Source Code 4",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "18", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
  ], sem5: [
    { name: "Exam Guess 5", price: "110", img: "images/cprog.jpg" },
    { name: "Notes 5", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 5", price: "15", img: "images/math.jpg" },
    { name: "Source Code 5",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "18", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
  ], 
  sem6: [
    { name: "Exam Guess 6", price: "110", img: "images/cprog.jpg" },
    { name: "Notes 6", price: "12", img: "images/intro.jpg" },
    { name: "PYQ 6", price: "15", img: "images/math.jpg" },
    { name: "Source Code 6",  price: "114", img: "images/digital.jpg" },
    { name: "Ethicial HackingBasic", price: "9", img: "images/it.jpg" },
    { name: "Social Engineering ", price: "18", img: "images/english.jpg" },
    { name: "Phishing", price: "18", img: "images/lab.jpg" },
    { name: "Linux", price: "20", img: "images/problem.jpg" }
    ]
};

// ------------------- DOM Elements -------------------
const productContainer = document.getElementById("productContainer");
const semesterSelect = document.getElementById("semesterSelect");
const searchBar = document.getElementById("searchBar");
const buyCountEl = document.getElementById("buyCount");
const visitorCountEl = document.getElementById("visitorCount");
const statusResultEl = document.getElementById("statusResult");

let currentSem = "sem1", selectedProduct = "";

// ------------------- Initialize Visitor & Buy Count -------------------
async function initCounts(){
  const visitorRef = doc(db,"storeInfo","visitorCount");
  const buyCountRef = doc(db,"storeInfo","buyCount");

  const vSnap = await getDoc(visitorRef);
  let vCount = 1;
  if(vSnap.exists()){ vCount = vSnap.data().total+1; await updateDoc(visitorRef,{total:vCount}); }
  else{ await setDoc(visitorRef,{total:1}); }
  visitorCountEl.textContent = "Visitors: "+vCount;

  const bSnap = await getDoc(buyCountRef);
  if(!bSnap.exists()) await setDoc(buyCountRef,{total:0});
  onSnapshot(buyCountRef, snap=>{ buyCountEl.textContent = "Total Buyers: "+snap.data().total; });
}

// ------------------- Display Products -------------------
function displayProducts(sem){
  productContainer.innerHTML = "";
  semesters[sem].forEach(p=>{
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<img src="${p.img}"><h4>${p.name}</h4><p>${p.price}</p>
      <button class='btn' onclick="openModal('${p.name}','${p.price}')">Buy via WhatsApp</button>`;
    productContainer.appendChild(div);
  });
}

semesterSelect.addEventListener("change", e=>{ currentSem = e.target.value; displayProducts(currentSem); });
searchBar.addEventListener("keyup", ()=>{
  const queryText = searchBar.value.toLowerCase();
  productContainer.innerHTML="";
  semesters[currentSem].filter(p=>p.name.toLowerCase().includes(queryText)).forEach(p=>{
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<img src="${p.img}"><h4>${p.name}</h4><p>${p.price}</p>
      <button class='btn' onclick="openModal('${p.name}','${p.price}')">Buy via WhatsApp</button>`;
    productContainer.appendChild(div);
  });
});

// ------------------- Modal -------------------
window.openModal = function(name, price){ selectedProduct = name + " - " + price; document.getElementById("formModal").style.display = "flex"; }
window.closeModal = function(){ document.getElementById("formModal").style.display = "none"; }

// ------------------- Generate Order ID -------------------
function generateOrderId(){ return 'ORD-'+Math.random().toString(36).substr(2,9).toUpperCase(); }

// ------------------- Place Order -------------------
window.placeOrder = async function(){
  const name = document.getElementById("custName").value;
  const email = document.getElementById("custEmail").value;
  const mobile = document.getElementById("custMobile").value;
  const orderId = generateOrderId();

  await addDoc(collection(db,"orders"),{
    orderId, product:selectedProduct, name, email, mobile,
    status:"Order Placed", time:serverTimestamp()
  });
  await updateDoc(doc(db,"storeInfo","buyCount"),{total:increment(1)});

  const msg = `New Order - ${selectedProduct}%0AOrder ID: ${orderId}%0AName: ${name}%0AEmail: ${email}%0AMobile: ${mobile}`;
  window.open(`https://wa.me/918986003559?text=${msg}`,'_blank');
  closeModal();

  setTimeout(async()=>{
    const feedback = prompt("Please give feedback for your purchase:");
    if(feedback){
      await addDoc(collection(db,"feedbacks"),{orderId, product:selectedProduct, feedback, time:serverTimestamp()});
    }
  },1000);

  alert("Your Order ID: "+orderId+" - Please keep it safe to check status.");
}

// ------------------- Live Order Status -------------------
let currentOrderListener = null;

document.getElementById("checkOrder").addEventListener("input", e=>{
  const orderId = e.target.value.trim();
  statusResultEl.textContent = "";

  if(currentOrderListener) currentOrderListener(); // Remove previous listener
  if(orderId.length < 5) return;

  const ordersCol = collection(db,"orders");
  const q = query(ordersCol, where("orderId","==",orderId));

  currentOrderListener = onSnapshot(q, snap=>{
    if(!snap.empty){
      snap.forEach(doc=>{
        const data = doc.data();
        statusResultEl.textContent = `Order Status: ${data.status}`;
      });
    } else {
      statusResultEl.textContent = "Order not found!";
    }
  });
});

// ------------------- Initialize -------------------
displayProducts(currentSem);
initCounts();
</script>
</body>
</html>
